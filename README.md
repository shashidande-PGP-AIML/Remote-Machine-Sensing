# Remote Machnine Sensing
The Challenge of detecting gas leaks with mobile robots.

### Introduction
In this body of work we describe the design, construction and validation of a mobile sensory platform for gas leak monitoring. The complete system consists of a sensory system on board a small quadrotor (i.e., a four rotor mini-UAV). The goals of this system include taking mesurements of gases, sensing and identifying their source. There are many challenges in building a mobile sensory platform. We have to pay special attention to the robot perception and decisión-making processes and develop the capabilities necessary for an effcient, autonomous robot. In order to achive that we need to tackle the following design challenges. 
- Gas sensing and development of olfactory capability
- Design of perception, decision and actuation system
- Quadrotor's limited payload
- The sensors layout and placement in order to have the least possible influence of the rotors.

### Gas Sensing
Olfaction is a valuable source of information about the environment that has not been sufficiently exploited in mobile robotics yet. We claim that data provided by e-noses may have an important added-value when combined with other sensing modalities (particularly, vision), and also when olfaction is integrated into the robot high-level processes.

Gas sensing is the task of detecting volatile substances and providing a conversion of that information into a signal or electrical magnitude readable by an operator or instrument. In the field of artificial olfaction, devices that fullfill this task are known as Electronic noses(e-nose). 

E-noses are devices conceived to detect and monitorize the concentration and composition of volatile substances by means of an array of non-selective gas sensors and some kind of pattern recognition algorithm. Their exploitation can be classified into two main categories according to the level of control over the measurement conditions: Closed Sampling Systems (CSS), where gas sensors are usually hosted in test chambers with controlled airflow, volatile exposure times, temperature and humidity, etc., and Open Sampling Systems (OSS), with no control over the sensing conditions. Our interest is in the latter, which are more flexible and practical for field applications, specially when accomplished with the help of a mobile robot carrying the e-nose on board, which makes the sensing task even more challenging. Particularly, we have to study and propose different approaches to overcome one of the main drawbacks of metal oxide gas transducers (MOX) when used on OSS, their slow recovery.

### The Multi-Chamber E-nose (MCE-nose)
The MCE-nose is a novel design of e-nose which overcomes, to a great extent, the important limitation of the "slow recovery" of gas sensors. The proposed MCE-nose comprises several identical sets of metal oxide (MOX) transducers accommodated in separate chambers, which alternate between sensing and recovery states, providing, as a whole, a device capable of sensing changes in chemical concentrations faster. The utility and performance of the MCE-nose has been shown through several experiments involving the sensing of volatile substances featuring rapid changes in concentration, and the generation of gas distribution maps with mobile robots

The MCE-nose pretends to work in a similar way that wine testers, but taking advantage of the reproducibility of electronic devices to avoid the down-time between readings. Thus, the key idea behind the proposed design is to ignore the gas sensor array output when the decay phase is detected, and delegate the sensing task to another clean, almost identical array of sensors. In order to achieve that, we accommodate a set of redundant sensors in different chambers, which are alternatively activated. Thus, the output signal of the whole setup results from the concatenation of the rise phases of a sequence of MOX sensor arrays.

### Gas Distribution Mapping with Obstacle Information
Gas distribution mapping (GDM) is the process of creating a representation of how gases spread in an environment from a set of spatially and temporally distributed measurements of relevant variables. Foremost, these measurements include the gas concentration itself, but may also comprise wind, pressure or temperature. In the last decade, GDM is gaining attention in the mobile robotics community because of the advantages a mobile robot offers when compared with the traditional approach based on networks of static gas sensors []. To start with, a mobile robot usually carries only one but more expensive and powerful gas sensing device (e-nose), which can analyze more complex compounds [], and detect faster changes in the gas concentration []. Also, the robot can sample at a higher (and adaptive) resolution, while still providing the required accurate localization of each measurement. Moreover, the gas distribution map is created by a robot in an online fashion, allowing decision making to occur depending on such a map, e.g. for exploration tasks.

Finally, a mobile robot can leverage environmental information provided by other sensors on board (cameras, laser scanners, etc.) to both enhance the GDM process itself, for example by detecting obstacles, as proposed in this paper, and to help in any other odor-related task, as can be the identification of potential gas sources []. Building a gas distribution model with a mobile robot turns out to be a tough problem for a number of reasons. First of all, and in contrast to most exteroceptive sensors employed in mobile robotics, an e-nose is a point sampling device1, that is, it only samples the very near air around it. Furthermore, the dispersion of gases is strongly conditioned by the presence of large obstacles (i.e. objects) in the environment, such as walls and furniture. Consequently, when building a GDM, they should indeed be taken into consideration to yield accurate estimations. Finally, but not less important, odors are ephemeral due to the mechanisms that rule gas dispersion [] (with a strong predominance of advection and turbulence over molecular diffusion). 

Thus, we can say that the information conveyed by a given measurement quickly vanishes as time goes by. The two latest points are pivotal characteristics that have been overlooked by previous works on GDM []. Traditionally, the influence of obstacles in the gas distribution has been only considered explicitly for the simulation of the gas dispersal [], and in some works on plume tracking []. However, when facing the GDM problem the information related to obstacles is neglected, leading to maps where nearby areas are always correlated, even when physical obstacles separate them. Moreover, existing approaches to GDM provide the same confidence to all gas measurements regardless of when they were taken. As a result, the estimated gas distribution averages out measurements taken at very different moments in time, something that strongly contradicts the vanishing nature of gases (odors). The example in Figure 1, which illustrates the discussion above, shows a robot which is commanded to inspect the different rooms of a house to determine, for example, the possible existence of bad odors. As it moves, the robot collects new gas observations that are incorporated to the GDM. Occasionally the same place is revisited, thus samples from the same location must be somehow combined. Since time-separated observations are gathered at close locations (e.g. samples at t1 and t2), the GDM method has to deal with these questions: (i) are observations taken at t1 and t2 equally relevant?, and (ii) if not, how do their significances evolve over time? Furthermore, the GDM method has to settle how to account for the obstacles whose presence significantly alter the gas distribution. 

That is, to provide an estimation of the gas distribution based only on the observations collected along the covered path, or to additionally account for objects such as walls and furniture to model the correlation between the areas they separate (e.g. the presence of bad odors in the kitchen do not imply the same at bedroom-3, since its gas concentration can be considered ’independent’ given the presence of walls and the closed door). We can summarize the two contributions of the present work as follows. First, we propose accounting for the obstacles in the environment, obtaining maps which are more compliant with the mechanisms of gas dispersion. Secondly, we claim that the “age” of a measurement is of relevance in the GDM process. In particular, we propose to associate a time-decreasing weight to each gas measurement, modeling the fact that recent measurements represent the current gas distribution more faithfully than older ones. Thus, observations taken at the same locations and separated in time will be combined according to their respective weights. As estimation tool for the gas mapping process, we propose to employ a Gaussian Markov random field (GMRF), which perfectly suits the characteristics of GDM by accounting not only for the information carried by the gas observations, but also for any prior knowledge which, in our case, includes both the obstacles in the environment (detected by the robot sensors), and the physics of how gases spatially distribute.

### Smart E-Nose for Spatio-Temporal Olfactory Analysis
The detection and measurement of chemical substances is essential for a number of applications such as security, leak detection, or pollution monitoring. Among them, an important subset demands the reliable characterization of chemical substances over long periods of time and/or over large areas, constraining the use of classical instruments such as gas chromatographers or mass spectrometers in favor of more portable devices, being e-noses a practical and effective
alternative.

An e-nose detects and recognizes chemical volatile substances by means of an array of gas sensors and some kind of pattern recognition algorithm. The working principle consists of exposing the air sample to the sensor array, which induces a reversible physical and/or chemical change in the sensing material which causes in turn an associated variation in electrical properties, such as conductivity. 

Many are the e-nose prototypes developed for the discrimination of complex vapor mixtures in diverse application fields However, these prototypes are not suitable for applications requiring some additional information apart from the common gas concentration and identification. Applications needing the time-stamp and location of the gas measurements to infer the gas distribution, or the temperature, pressure and humidity for the correction of the samples, demand using the e-nose together with other instruments and devices, thus resulting in inconvenient, non-handheld systems.

Furthermore, most existing e-noses are designed to work for a reduced set of target substances adaptable to different applications, needing different e-noses for targeting different compounds.  A novel e-nose conceived upon a configurable architecture which integrates independent, plug&play, smart modules. This architecture allows for quick
and easy adaptation to the application requirements by selecting the appropriate modules (chemical or physical sensors,
communication interfaces, batteries, GPS, etc.), while keeping a compact design with reduced dimensions and weight. Furthermore, its ability to geo-reference the gas measurements make it suitable for applications that require spatio-temporal data analysis.


### Platform Analysis
The primary alternatives to the proposed mini-UAV sensory system are Wireless Sensor Networks (WSNs) and Unmanned Ground Vehicles (UGVs). Both of them are well-known solutions that have been applied in the context of greenhouse agriculture. Despite this fact, the WSNs and UGVs are hindered by limitations that UAVs can overcome.

The primary advantage of WSNs is simultaneous measurements at various points, which a UGV or UAV cannot perform and may be desirable for this application. WSNs are a robust solution due to their simplicity, which reduces the probability of failure, and their modularity, which allows working with damaged motes. Conversely, in contrast to UGVs and UAVs, WSNs are not able to move within the workspace to take measures at points of interest. In addition, the costs of WSNs strongly depend on the number of motes, which may reach hundreds in a medium size greenhouse. This multiplication of motes (e.g., sensors, controllers, batteries and communication modules) makes their costs higher than the costs of UGVs or UAVs.

UGVs tend to have lower costs than WSNs and are competitive against UAVs. The simplicity of their mechanic elements and control systems makes their costs lower than the costs of UAVs. In addition, UGVs can move to the points of interest; however, these movements are restricted to the ground, preventing them from reaching certain points of interest due to obstacles such as plants and covers. Conversely, UAVs can obtain measurements at nearly any point in a three dimensional space including at different altitudes. This fact is interesting not only for reducing the number of sensors and therefore the total cost of such a system but also for obtaining local data for production monitoring, problem detection (e.g., a break in a plastic cover) and local climate control. In summary, the characteristics of UAVs make them a competitive option for measuring the environmental variables of greenhouses and justify this research.

### Integration of Sensors
The sensors have been integrated to satisfy two needs: the collection and storage of measurements including space and time references; and the communication between the mini-UAV sensory system and the greenhouse management system. Several alternatives for the integration of sensors have been studied, and two prototypes have been developed: one with an Arduino UNO and another with a Raspberry Pi. Both prototypes have been compared with multiple criteria including size, weight, performance and connectivity. The Raspberry Pi has ultimately been chosen instead of the Arduino UNO due to its performance, connectivity and programming. The Raspberry Pi has better performance than the Arduino UNO, both in hardware (e.g., processor speed and memory) and software (i.e., operating system), which allows it to preprocess data while measuring. Additionally, the Raspberry Pi typically has better performance when connected to Wi-Fi networks and exchanging data with other devices. Finally, the Raspberry Pi provides additional programming capabilities including full integration with Robot Operating System (ROS).

### Location of Sensors
The location of sensors on the quadrotor is not a trivial issue and requires the study of some conditions. Both the air-flows produced by the rotors and the light and shadow conditions can affect the sensor measurements. Additionally, the weights of the sensors influence the weight and inertia of the quadrotor, which can in turn affect navigation.

Specifically, the temperature and humidity sensor can be affected by solar radiation and the airflows of the rotors, the luminosity sensor is obviously conditioned by solar radiation and the carbon dioxide sensor can be affected by the air-flows of the rotors.

Two previous studies have addressed quadrotor aerodynamics with similar results [cite here]. Their conclusions stated that when considering an isolated rotor, the airspeed is maximum at its perimeter and minimum in the center and the exterior of the quadrotor; moreover, considering all rotors, the airspeed is maximum near the rotors and minimum in the center and outside the quadrotor.

Based on the quadrotor aerodynamics and considering the effects of solar radiation, there are two possible sensor locations to consider: the center part of the top side of the quadrotor and outside the quadrotor at some distance. Considering both options, the first does not require a complex assembly that could modify the center of gravity of the quadrotor (e.g., an extension for the sensors) and therefore is selected for the location of the sensors. Unfortunately, the conclusions of both publications were focused on quadrotor design and modeling instead of sensor allocation. Therefore, a complementary exhaustive study of quadrotor aerodynamics oriented to sensor allocation was necessary.

Simulations of computational fluid dynamics (CFD) and real experiments for determining quadrotor airflows were performed to determine the relevant aerodynamics and validate the location of sensors.




